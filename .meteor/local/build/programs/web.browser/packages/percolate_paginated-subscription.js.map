{"version":3,"sources":["meteor://ðŸ’»app/packages/percolate_paginated-subscription/packages/percolate_paginated-subscription.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0F","file":"/packages/percolate_paginated-subscription.js","sourcesContent":["(function () {\n\n/////////////////////////////////////////////////////////////////////////////////\n//                                                                             //\n// packages/percolate:paginated-subscription/paginated_subscription.js         //\n//                                                                             //\n/////////////////////////////////////////////////////////////////////////////////\n                                                                               //\nPaginatedSubscriptionHandle = function(perPage) {                              // 1\n  this.perPage = perPage;                                                      // 2\n  this._limit = perPage;                                                       // 3\n  this._limitListeners = new Deps.Dependency();                                // 4\n  this._loaded = 0;                                                            // 5\n  this._loadedListeners = new Deps.Dependency();                               // 6\n}                                                                              // 7\n                                                                               // 8\nPaginatedSubscriptionHandle.prototype.loaded = function() {                    // 9\n  this._loadedListeners.depend();                                              // 10\n  return this._loaded;                                                         // 11\n}                                                                              // 12\n                                                                               // 13\nPaginatedSubscriptionHandle.prototype.limit = function() {                     // 14\n  this._limitListeners.depend();                                               // 15\n  return this._limit;                                                          // 16\n}                                                                              // 17\n                                                                               // 18\nPaginatedSubscriptionHandle.prototype.ready = function() {                     // 19\n  return this.loaded() === this.limit();                                       // 20\n}                                                                              // 21\n                                                                               // 22\n// deprecated                                                                  // 23\nPaginatedSubscriptionHandle.prototype.loading = function() {                   // 24\n  return ! this.ready();                                                       // 25\n}                                                                              // 26\n                                                                               // 27\nPaginatedSubscriptionHandle.prototype.loadNextPage = function() {              // 28\n  this._limit += this.perPage;                                                 // 29\n  this._limitListeners.changed();                                              // 30\n}                                                                              // 31\n                                                                               // 32\nPaginatedSubscriptionHandle.prototype.done = function() {                      // 33\n  this._loaded = this._limit;                                                  // 34\n  this._loadedListeners.changed();                                             // 35\n}                                                                              // 36\n                                                                               // 37\nPaginatedSubscriptionHandle.prototype.reset = function() {                     // 38\n  this._limit = this.perPage;                                                  // 39\n  this._limitListeners.changed();                                              // 40\n}                                                                              // 41\n                                                                               // 42\n                                                                               // 43\nMeteor.subscribeWithPagination = function (/*name, arguments, perPage */) {    // 44\n  var args = Array.prototype.slice.call(arguments, 0);                         // 45\n  var lastArg = args.pop();                                                    // 46\n  var perPage, cb;                                                             // 47\n  if (_.isFunction(lastArg) || _.isObject(lastArg)) {                          // 48\n    cb = lastArg;                                                              // 49\n    perPage = args.pop();                                                      // 50\n  } else {                                                                     // 51\n    perPage = lastArg;                                                         // 52\n  }                                                                            // 53\n                                                                               // 54\n  var handle = new PaginatedSubscriptionHandle(perPage);                       // 55\n                                                                               // 56\n  var argAutorun = Meteor.autorun(function() {                                 // 57\n    var ourArgs = _.map(args, function(arg) {                                  // 58\n      return _.isFunction(arg) ? arg() : arg;                                  // 59\n    });                                                                        // 60\n                                                                               // 61\n    ourArgs.push(handle.limit());                                              // 62\n    cb && ourArgs.push(cb);                                                    // 63\n    var subHandle = Meteor.subscribe.apply(this, ourArgs);                     // 64\n                                                                               // 65\n    // whenever the sub becomes ready, we are done. This may happen right away // 66\n    // if we are re-subscribing to an already ready subscription.              // 67\n    Meteor.autorun(function() {                                                // 68\n      if (subHandle.ready())                                                   // 69\n        handle.done();                                                         // 70\n    });                                                                        // 71\n  });                                                                          // 72\n                                                                               // 73\n  // this will stop the subHandle, and the done autorun                        // 74\n  handle.stop = _.bind(argAutorun.stop, argAutorun);                           // 75\n                                                                               // 76\n  return handle;                                                               // 77\n}                                                                              // 78\n                                                                               // 79\n/////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n"]}